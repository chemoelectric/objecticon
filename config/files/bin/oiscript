#!/bin/sh
if [ -z "$OIXCACHE" ] ; then
    OIXCACHE=/tmp/oixcache
fi
mkdir -p -m 777 $OIXCACHE
HASH=$OIXCACHE/`md5sum "$1" | cut -c1-32`
if [ ! -x $HASH ] ; then
    SRC=$OIXCACHE/src-$$.icn
    cp "$1" $SRC
    if ! oit -s -o $HASH $SRC ; then
        rm -f $SRC
        exit 1
    fi
    rm -f $SRC
    chmod 555 $HASH
fi
shift
$HASH "$@"
