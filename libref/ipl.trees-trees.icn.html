<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>trees.icn</title></head><body><pre>
<a name="1"/>############################################################################
<a name="2"/>#
<a name="3"/>#	File:     trees.icn
<a name="4"/>#
<a name="5"/>#	Subject:  Procedures for manipulating trees and dags
<a name="6"/>#
<a name="7"/>#	Author:   Ralph E. Griswold
<a name="8"/>#
<a name="9"/>#	Date:     December 27, 1995
<a name="10"/>#
<a name="11"/>############################################################################
<a name="12"/>#
<a name="13"/>#   This file is in the public domain.
<a name="14"/>#
<a name="15"/>############################################################################
<a name="16"/>#  
<a name="17"/>#       depth(t)	compute maximum depth of tree t
<a name="18"/>#  
<a name="19"/>#       ldag(s)		construct a dag from the string s
<a name="20"/>#
<a name="21"/>#       ltree(s)	construct a tree from the string s
<a name="22"/>#
<a name="23"/>#       stree(t)	construct a string from the tree t
<a name="24"/>#
<a name="25"/>#       tcopy(t)	copy tree t
<a name="26"/>#
<a name="27"/>#       teq(t1,t2)	compare trees t1 and t2
<a name="28"/>#  
<a name="29"/>#       visit(t)	visit, in preorder, the nodes of the tree t
<a name="30"/>#  
<a name="31"/>############################################################################
<a name="32"/>
<a name="33"/>package ipl.trees
<a name="34"/>
<a name="35"/># depth of tree
<a name="36"/>procedure depth(ltree)			
<a name="37"/>   local count
<a name="38"/>
<a name="39"/>   count := 0
<a name="40"/>   every count &lt;:= 1 + depth(ltree[2 to *ltree])
<a name="41"/>   return count
<a name="42"/>
<a name="43"/>end
<a name="44"/>
<a name="45"/># construct dag from string
<a name="46"/>procedure ldag(stree,done)		
<a name="47"/>   local L
<a name="48"/>
<a name="49"/>   /done := table()
<a name="50"/>   if L := \done[stree] then return L
<a name="51"/>   stree ?
<a name="52"/>      if L := [tab(upto('('))] then {
<a name="53"/>         move(1)
<a name="54"/>         while put(L,ldag(tab(bal(',)')),done)) do
<a name="55"/>            move(1)
<a name="56"/>         }
<a name="57"/>      else L := [tab(0)]
<a name="58"/>   return done[stree] := L
<a name="59"/>
<a name="60"/>end
<a name="61"/>
<a name="62"/># construct tree from string
<a name="63"/>procedure ltree(stree)			
<a name="64"/>   local L
<a name="65"/>
<a name="66"/>   stree ?
<a name="67"/>      if L := [tab(upto('('))] then {
<a name="68"/>         move(1)
<a name="69"/>         while put(L,ltree(tab(bal(',)')))) do
<a name="70"/>            move(1)
<a name="71"/>         }
<a name="72"/>      else L := [tab(0)]
<a name="73"/>   return L
<a name="74"/>
<a name="75"/>end
<a name="76"/>
<a name="77"/># construct string from tree
<a name="78"/>procedure stree(ltree)			
<a name="79"/>   local s
<a name="80"/>
<a name="81"/>   if *ltree = 1 then return ltree[1]
<a name="82"/>   s := ltree[1] || "("
<a name="83"/>   every s ||:= stree(ltree[2 to *ltree]) || ","
<a name="84"/>   return s[1:-1] || ")"
<a name="85"/>
<a name="86"/>end
<a name="87"/>
<a name="88"/># tree copy
<a name="89"/>procedure tcopy(ltree)			
<a name="90"/>   local L
<a name="91"/>
<a name="92"/>   L := [ltree[1]]
<a name="93"/>   every put(L,tcopy(ltree[2 to *ltree]))
<a name="94"/>   return L
<a name="95"/>
<a name="96"/>end
<a name="97"/>
<a name="98"/># tree equivalence
<a name="99"/>procedure teq(L1,L2)			
<a name="100"/>   local i
<a name="101"/>
<a name="102"/>   if *L1 ~= *L2 then fail
<a name="103"/>   if L1[1] ~== L2[1] then fail
<a name="104"/>   every i := 2 to *L1 do
<a name="105"/>      teq(L1[i],L2[i]) | fail
<a name="106"/>   return L2
<a name="107"/>
<a name="108"/>end
<a name="109"/>
<a name="110"/># visit nodes of tree
<a name="111"/>procedure visit(ltree)			
<a name="112"/>
<a name="113"/>   suspend ltree | visit(ltree[2 to *ltree])
<a name="114"/>
<a name="115"/>end
</pre></body></html>
