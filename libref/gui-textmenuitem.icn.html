<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>textmenuitem.icn</title></head><body><pre>
<a name="1"/>package gui
<a name="2"/>
<a name="3"/>#
<a name="4"/># This class encapsulates a single text item in a Menu.
<a name="5"/>#
<a name="6"/>class TextMenuItem(MenuComponent)
<a name="7"/>   public 
<a name="8"/>      paint_mid,
<a name="9"/>      paint_left,
<a name="10"/>      paint_right,
<a name="11"/>      border_mid,
<a name="12"/>      border_left,
<a name="13"/>      border_right
<a name="14"/>
<a name="15"/>   public override initially()
<a name="16"/>      MenuComponent.initially()
<a name="17"/>      # Note that having no paints is the case for a PopupMenu
<a name="18"/>      (\paint_mid).initially(parent_component, self.accel)
<a name="19"/>      (\paint_left).initially(parent_component)
<a name="20"/>      (\paint_right).initially(parent_component)
<a name="21"/>      border_mid.initially(parent_component)
<a name="22"/>      border_left.initially(parent_component)
<a name="23"/>      border_right.initially(parent_component)
<a name="24"/>   end
<a name="25"/>
<a name="26"/>   public override finally()
<a name="27"/>      MenuComponent.finally()
<a name="28"/>      (\paint_mid).finally()
<a name="29"/>      (\paint_left).finally()
<a name="30"/>      (\paint_right).finally()
<a name="31"/>      border_mid.finally()
<a name="32"/>      border_left.finally()
<a name="33"/>      border_right.finally()
<a name="34"/>   end
<a name="35"/>
<a name="36"/>   #
<a name="37"/>   # Set the centre label to the given string.
<a name="38"/>   #
<a name="39"/>   public set_label(x)
<a name="40"/>      return set_paint_mid(paint_for_string(x))
<a name="41"/>   end
<a name="42"/>
<a name="43"/>   #
<a name="44"/>   # Set the middle `Paint` instance.
<a name="45"/>   #
<a name="46"/>   public set_paint(p)
<a name="47"/>      return set_paint_mid(p)      
<a name="48"/>   end
<a name="49"/>
<a name="50"/>   #
<a name="51"/>   # Set the middle `Paint` instance.
<a name="52"/>   #
<a name="53"/>   public set_paint_mid(p)
<a name="54"/>      if is_initialized() then {
<a name="55"/>         (\self.paint_mid).finally()
<a name="56"/>         self.paint_mid := p
<a name="57"/>         (\self.paint_mid).initially(parent_component, self.accel)
<a name="58"/>         possibly_invalidate()
<a name="59"/>      } else
<a name="60"/>         self.paint_mid := p
<a name="61"/>      link
<a name="62"/>   end
<a name="63"/>
<a name="64"/>   #
<a name="65"/>   # Set the optional left label to the given string.
<a name="66"/>   #
<a name="67"/>   public set_label_left(x)
<a name="68"/>      return set_paint_left(paint_for_string(x))
<a name="69"/>   end
<a name="70"/>
<a name="71"/>   public set_paint_left(p)
<a name="72"/>      if is_initialized() then {
<a name="73"/>         (\self.paint_left).finally()
<a name="74"/>         self.paint_left := p
<a name="75"/>         (\self.paint_left).initially(parent_component)
<a name="76"/>         possibly_invalidate()
<a name="77"/>      } else
<a name="78"/>         self.paint_left := p
<a name="79"/>      link
<a name="80"/>   end
<a name="81"/>
<a name="82"/>   #
<a name="83"/>   # Set the optional right label to the given string.
<a name="84"/>   #
<a name="85"/>   public set_label_right(x)
<a name="86"/>      return set_paint_right(paint_for_string(x))
<a name="87"/>   end
<a name="88"/>
<a name="89"/>   public set_paint_right(p)
<a name="90"/>      if is_initialized() then {
<a name="91"/>         (\self.paint_right).finally()
<a name="92"/>         self.paint_right := p
<a name="93"/>         (\self.paint_right).initially(parent_component)
<a name="94"/>         possibly_invalidate()
<a name="95"/>      } else
<a name="96"/>         self.paint_right := p
<a name="97"/>      link
<a name="98"/>   end
<a name="99"/>
<a name="100"/>   public set_image_left(x)
<a name="101"/>      return set_paint_left(ImagePaint().set_image(x))
<a name="102"/>   end
<a name="103"/>
<a name="104"/>   public set_image_right(x)
<a name="105"/>      return set_paint_right(ImagePaint().set_image(x))
<a name="106"/>   end
<a name="107"/>
<a name="108"/>   public set_border_left(x)
<a name="109"/>      if is_initialized() then {
<a name="110"/>         self.border_left.finally()
<a name="111"/>         self.border_left := x
<a name="112"/>         self.border_left.initially(parent_component)
<a name="113"/>         possibly_invalidate()
<a name="114"/>      } else
<a name="115"/>         self.border_left := x
<a name="116"/>      link
<a name="117"/>   end
<a name="118"/>
<a name="119"/>   public set_border_right(x)
<a name="120"/>      if is_initialized() then {
<a name="121"/>         self.border_right.finally()
<a name="122"/>         self.border_right := x
<a name="123"/>         self.border_right.initially(parent_component)
<a name="124"/>         possibly_invalidate()
<a name="125"/>      } else
<a name="126"/>         self.border_right := x
<a name="127"/>      link
<a name="128"/>   end
<a name="129"/>
<a name="130"/>   public set_border_mid(x)
<a name="131"/>      if is_initialized() then {
<a name="132"/>         self.border_mid.finally()
<a name="133"/>         self.border_mid := x
<a name="134"/>         self.border_mid.initially(parent_component)
<a name="135"/>         possibly_invalidate()
<a name="136"/>      } else
<a name="137"/>         self.border_mid := x
<a name="138"/>      link
<a name="139"/>   end
<a name="140"/>
<a name="141"/>   public override get_label_left_width()
<a name="142"/>      return (\paint_left).w + border_left.get_total_width()
<a name="143"/>   end
<a name="144"/>
<a name="145"/>   public override get_label_left_height()
<a name="146"/>      return (\paint_left).h + border_left.get_total_height()
<a name="147"/>   end
<a name="148"/>
<a name="149"/>   public override get_label_mid_width()
<a name="150"/>      return (\paint_mid).w + border_mid.get_total_width()
<a name="151"/>   end
<a name="152"/>
<a name="153"/>   public override get_label_mid_height()
<a name="154"/>      return (\paint_mid).h + border_mid.get_total_height()
<a name="155"/>   end
<a name="156"/>
<a name="157"/>   public override get_label_right_width()
<a name="158"/>      return (\paint_right).w + border_right.get_total_width()
<a name="159"/>   end
<a name="160"/>
<a name="161"/>   public override get_label_right_height()
<a name="162"/>      return (\paint_right).h + border_left.get_total_height()
<a name="163"/>   end
<a name="164"/>
<a name="165"/>   public override draw_label(W, lw, mw, rw)
<a name="166"/>      local r
<a name="167"/>
<a name="168"/>      r := Rect(label_x, label_y, lw, label_h)
<a name="169"/>      if lw &gt; 0 &amp; \paint_left then {
<a name="170"/>         border_left.draw(W, r.x, r.y, r.w, r.h)
<a name="171"/>         paint_left.draw_rect(W, border_left.float(r, paint_left))
<a name="172"/>      }
<a name="173"/>      r.x +:= lw
<a name="174"/>
<a name="175"/>      if mw &gt; 0 &amp; \paint_mid then {
<a name="176"/>         r.w := mw
<a name="177"/>         border_mid.draw(W, r.x, r.y, r.w, r.h)
<a name="178"/>         paint_mid.draw_rect(W, border_mid.float(r, paint_mid))
<a name="179"/>      }
<a name="180"/>      r.x +:= mw
<a name="181"/>
<a name="182"/>      if rw &gt; 0 &amp; \paint_right then {
<a name="183"/>         r.w := rw
<a name="184"/>         border_right.draw(W, r.x, r.y, r.w, r.h)
<a name="185"/>         paint_right.draw_rect(W, border_right.float(r, paint_right))
<a name="186"/>      }
<a name="187"/>   end
<a name="188"/>
<a name="189"/>   public override new()
<a name="190"/>      MenuComponent.new()
<a name="191"/>      #
<a name="192"/>      # The three labels use the following X insets by default :-
<a name="193"/>      #      XllllXcccXrrrrX
<a name="194"/>      #      &lt;-l-&gt;&lt;-m-&gt;&lt;-r-&gt;
<a name="195"/>      # where X is Gui.X_INSET
<a name="196"/>      #
<a name="197"/>      self.border_mid := EmptyBorder().set_x_align("l")
<a name="198"/>      self.border_left := EmptyBorder().set_r_inset(0).set_x_align("l")
<a name="199"/>      self.border_right := EmptyBorder().set_l_inset(0).set_x_align("l")
<a name="200"/>      return
<a name="201"/>   end
<a name="202"/>end
<a name="203"/>
<a name="204"/>
</pre></body></html>
