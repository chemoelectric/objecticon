<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>xformimg.icn</title></head><body><pre>
<a name="1"/>############################################################################
<a name="2"/>#
<a name="3"/>#	File:     xformimg.icn
<a name="4"/>#
<a name="5"/>#	Subject:  Procedures to transform image
<a name="6"/>#
<a name="7"/>#	Author:   Ralph E. Griswold
<a name="8"/>#
<a name="9"/>#	Date:     February 4, 1995
<a name="10"/>#
<a name="11"/>############################################################################
<a name="12"/>#
<a name="13"/>#   This file is in the public domain.
<a name="14"/>#
<a name="15"/>############################################################################
<a name="16"/>#
<a name="17"/>#  These procedures perform reflections, rotations, and concatenations
<a name="18"/>#  of images.
<a name="19"/>#
<a name="20"/>#  Warning:  Some of these operations are slow.
<a name="21"/>#
<a name="22"/>############################################################################
<a name="23"/>#
<a name="24"/>#  Requires:  Version 9 graphics
<a name="25"/>#
<a name="26"/>############################################################################
<a name="27"/>#
<a name="28"/>#  Links:  numbers, wattrib, wopen
<a name="29"/>#
<a name="30"/>############################################################################
<a name="31"/>
<a name="32"/>package ipl.xformimg
<a name="33"/>
<a name="34"/>import
<a name="35"/>   graphics(Pixels, Window)
<a name="36"/>
<a name="37"/>procedure wreflect(win1, dir)
<a name="38"/>   local win2, width, height, px1, px2, p
<a name="39"/>
<a name="40"/>   /dir := "v"				# vertical reflection is the default
<a name="41"/>
<a name="42"/>   height := win1.get_height()
<a name="43"/>   width := win1.get_width()
<a name="44"/>
<a name="45"/>   win2 := Window(win1.get_display()).set_size(width, height) |
<a name="46"/>      syserr("Cannot create window for reflection")
<a name="47"/>
<a name="48"/>   case dir of {
<a name="49"/>      "v":  {
<a name="50"/>         px1 := win1.get_pixels()
<a name="51"/>         px2 := Pixels(width, height)
<a name="52"/>         every p := px1.gen_rgba() do
<a name="53"/>            px2.set_rgba(p.x, height - 1 - p.y, p.red, p.green, p.blue)
<a name="54"/>         px1.close()
<a name="55"/>         win2.draw_image(,, px2)
<a name="56"/>         px2.close()
<a name="57"/>         }
<a name="58"/>      "h":  {
<a name="59"/>         px1 := win1.get_pixels()
<a name="60"/>         px2 := Pixels(width, height)
<a name="61"/>         every p := px1.gen_rgba() do
<a name="62"/>            px2.set_rgba(width - 1 - p.x, p.y, p.red, p.green, p.blue)
<a name="63"/>         px1.close()
<a name="64"/>         win2.draw_image(,, px2)
<a name="65"/>         px2.close()
<a name="66"/>         }
<a name="67"/>      default:  runerr("Invalid specification for reflect()", dir)
<a name="68"/>      }
<a name="69"/>
<a name="70"/>   return win2
<a name="71"/>
<a name="72"/>end
<a name="73"/>
<a name="74"/>procedure wrotate(win1, dir)
<a name="75"/>   local win2, width, height, px1, px2, p
<a name="76"/>
<a name="77"/>   /dir := "90"				# 90-degree rotation is the default
<a name="78"/>
<a name="79"/>   height := win1.get_height()
<a name="80"/>   width := win1.get_width()
<a name="81"/>
<a name="82"/>
<a name="83"/>   case integer(dir) of {
<a name="84"/>      90:  {
<a name="85"/>         win2 := Window(win1.get_display()).set_size(height, width) | syserr("Cannot open target window")
<a name="86"/>         px1 := win1.get_pixels()
<a name="87"/>         px2 := Pixels(height, width)
<a name="88"/>         every p := px1.gen_rgba() do
<a name="89"/>            px2.set_rgba(height - 1 - p.y, p.x, p.red, p.green, p.blue)
<a name="90"/>         px1.close()
<a name="91"/>         win2.draw_image(,, px2)
<a name="92"/>         px2.close()
<a name="93"/>         }
<a name="94"/>      -90:  {
<a name="95"/>         win2 := Window(win1.get_display()).set_size(height, width) | syserr("Cannot open target window")
<a name="96"/>         px1 := win1.get_pixels()
<a name="97"/>         px2 := Pixels(height, width)
<a name="98"/>         every p := px1.gen_rgba() do
<a name="99"/>            px2.set_rgba(p.y, width - 1 - p.x, p.red, p.green, p.blue)
<a name="100"/>         px1.close()
<a name="101"/>         win2.draw_image(,, px2)
<a name="102"/>         px2.close()
<a name="103"/>         }
<a name="104"/>      180:  {
<a name="105"/>         win2 := Window(win1.get_display()).set_size(width, height) | syserr("Cannot open target window")
<a name="106"/>         px1 := win1.get_pixels()
<a name="107"/>         px2 := Pixels(width, height)
<a name="108"/>         every p := px1.gen_rgba() do
<a name="109"/>            px2.set_rgba(width - 1 - p.x, height - 1 - p.y, p.red, p.green, p.blue)
<a name="110"/>         px1.close()
<a name="111"/>         win2.draw_image(,, px2)
<a name="112"/>         px2.close()
<a name="113"/>         }
<a name="114"/>      default:  runerr("Invalid specification for rotate()", dir)
<a name="115"/>      } | runerr("Invalid specification for rotate()", dir)
<a name="116"/>
<a name="117"/>   return win2
<a name="118"/>
<a name="119"/>end
<a name="120"/>
<a name="121"/>procedure wcatenate(win1, win2, dir)
<a name="122"/>   local width1, width2, height1, height2, win3
<a name="123"/>
<a name="124"/>   /dir := "h"			# horizontal concatenation is the default
<a name="125"/>
<a name="126"/>   width1 := win1.get_width()
<a name="127"/>   width2 := win2.get_width()
<a name="128"/>   height1 := win1.get_height()
<a name="129"/>   height2 := win2.get_height()
<a name="130"/>
<a name="131"/>   case dir of {
<a name="132"/>      "h":  {
<a name="133"/>         win3 := Window(win1.get_display()).set_size(width1 + width2, max(height1, height2)) |
<a name="134"/>               syserr("Cannot open window for concatenation")
<a name="135"/>         win1.copy_to(,,,, win3)
<a name="136"/>         win2.copy_to(0, 0, width2, height2, 
<a name="137"/>                      win3, width1, 0)
<a name="138"/>         }
<a name="139"/>      "v":  {
<a name="140"/>         win3 := Window(win1.get_display()).set_size(max(width1, width2), height1 + height2) |
<a name="141"/>               syserr("Cannot open window for concatenation")
<a name="142"/>         win1.copy_to(,,,, win3)
<a name="143"/>         win2.copy_to(0, 0, width2, height2, 
<a name="144"/>                      win3, 0, height1)
<a name="145"/>         }
<a name="146"/>      default:  runerr("Invalid specification for catenate()", dir)
<a name="147"/>      }
<a name="148"/>
<a name="149"/>   return win3
<a name="150"/>
<a name="151"/>end
</pre></body></html>
