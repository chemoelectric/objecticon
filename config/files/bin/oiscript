#!/bin/sh
if [ -z "$OIX_CACHE" ] ; then
    OIX_CACHE=/tmp/oixcache
fi
mkdir -p -m 777 $OIX_CACHE
HASH=$OIX_CACHE/`md5sum "$1" | cut -c1-32`
if [ ! -x $HASH ] ; then
    SRC=$OIX_CACHE/src-$$.icn
    cp "$1" $SRC
    if ! oit -s -o $HASH $SRC ; then
        rm -f $SRC
        exit 1
    fi
    rm -f $SRC
    chmod 555 $HASH
fi
shift
$HASH "$@"
