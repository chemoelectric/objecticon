<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>htmlformatter.icn</title></head><body><pre>
<a name="1"/>#
<a name="2"/># $Id: htmlformatter.icn 8783 2020-12-27 20:18:51Z rparlett $
<a name="3"/>#
<a name="4"/># This file is in the public domain.
<a name="5"/>#
<a name="6"/># Author: Robert Parlett (parlett@dial.pipex.com)
<a name="7"/>#
<a name="8"/>
<a name="9"/>package xml
<a name="10"/>
<a name="11"/>#
<a name="12"/># A formatter for outputting HTML documents
<a name="13"/>#
<a name="14"/>class HtmlFormatter(Formatter)
<a name="15"/>   protected override format_document(n)
<a name="16"/>      local c
<a name="17"/>      every c := !n.children do {
<a name="18"/>         format_node(c)
<a name="19"/>         write()
<a name="20"/>      }
<a name="21"/>   end
<a name="22"/>
<a name="23"/>   protected override format_content(s)
<a name="24"/>      writes1(s)
<a name="25"/>   end
<a name="26"/>
<a name="27"/>   protected override format_doctype(n)
<a name="28"/>      local s, x
<a name="29"/>      s := "&lt;!DOCTYPE "
<a name="30"/>      s ||:= \n.name
<a name="31"/>      x := n.external_id
<a name="32"/>      if \x then {
<a name="33"/>         if \x.public_id then {
<a name="34"/>            if \x.system_id then
<a name="35"/>               s ||:= " PUBLIC \"" || x.public_id || "\" \"" || x.system_id || "\""
<a name="36"/>            else
<a name="37"/>               s ||:= " PUBLIC \"" || x.public_id
<a name="38"/>         } else
<a name="39"/>            s ||:= " SYSTEM \"" || \x.system_id || "\""
<a name="40"/>      }
<a name="41"/>      s ||:= "&gt;"
<a name="42"/>      writes1(s)
<a name="43"/>   end
<a name="44"/>
<a name="45"/>   protected override format_comment(n)
<a name="46"/>      writes("&lt;!--", n.comment, "--&gt;")
<a name="47"/>   end
<a name="48"/>
<a name="49"/>   protected override format_element(n)
<a name="50"/>      local s, l, e
<a name="51"/>
<a name="52"/>      s := "&lt;" || n.name
<a name="53"/>
<a name="54"/>      every l := !sort(n.attributes) do {
<a name="55"/>         if \l[2] then
<a name="56"/>            s ||:= " " || l[1] || "=\"" || xml_escape(l[2], '&amp;&lt;&gt;\"') || "\""
<a name="57"/>         else
<a name="58"/>            s ||:= " " || l[1]
<a name="59"/>      }
<a name="60"/>
<a name="61"/>      s ||:= "&gt;"
<a name="62"/>      writes1(s)
<a name="63"/>
<a name="64"/>      every e := !n.children do {
<a name="65"/>         if text(e) then
<a name="66"/>            writes1(xml_escape(e, '&amp;&lt;&gt;\"'))
<a name="67"/>         else
<a name="68"/>            format_node(e)
<a name="69"/>      }
<a name="70"/>
<a name="71"/>      unless HtmlParser.is_standalone_tag(n.name) then
<a name="72"/>         writes("&lt;/", n.name, "&gt;")
<a name="73"/>   end
<a name="74"/>
<a name="75"/>   protected override format_pi(n) end
<a name="76"/>   protected override format_cdata(n) end
<a name="77"/>   protected override format_xmldecl(n) end
<a name="78"/>
<a name="79"/>end
<a name="80"/>
</pre></body></html>
