<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>feval.icn</title></head><body><pre>
<a name="1"/>############################################################################
<a name="2"/>#
<a name="3"/>#	File:     feval.icn
<a name="4"/>#
<a name="5"/>#	Subject:  Procedure to evaluate string as function call
<a name="6"/>#
<a name="7"/>#	Author:   Ralph E. Griswold
<a name="8"/>#
<a name="9"/>#	Date:     June 8, 1994
<a name="10"/>#
<a name="11"/>############################################################################
<a name="12"/>#
<a name="13"/>#   This file is in the public domain.
<a name="14"/>#
<a name="15"/>############################################################################
<a name="16"/>#
<a name="17"/>#  This procedure analyzes a string representing an Icon function or
<a name="18"/>#  procedure call and evaluates the result.
<a name="19"/>#
<a name="20"/>#  It assumes the string is well-formed.  The arguments can only be
<a name="21"/>#  Icon literals. Escapes, commas, and parentheses in strings literals
<a name="22"/>#  are not handled.
<a name="23"/>#
<a name="24"/>############################################################################
<a name="25"/>#
<a name="26"/>#  Links:  ivalue
<a name="27"/>#
<a name="28"/>############################################################################
<a name="29"/>
<a name="30"/>package ipl.feval
<a name="31"/>
<a name="32"/>import
<a name="33"/>   io(ewrite),
<a name="34"/>   ipl.ivalue(ivalue)
<a name="35"/>
<a name="36"/>procedure feval(s)
<a name="37"/>   local fnc, argl
<a name="38"/>
<a name="39"/>   s ? {
<a name="40"/>      unless fnc := tab(upto('(')) then {
<a name="41"/>         ewrite("*** syntax error")
<a name="42"/>         fail
<a name="43"/>         }
<a name="44"/>      unless fnc := proc(fnc, 3 to 1 by -1) then {
<a name="45"/>         ewrite("*** invalid function or operation")
<a name="46"/>         fail
<a name="47"/>         }
<a name="48"/>      move(1)
<a name="49"/>
<a name="50"/>      argl := []
<a name="51"/>      while put(argl, ivalue(tab(upto(',)')))) do move(1)
<a name="52"/>
<a name="53"/>      suspend fnc ! argl
<a name="54"/>      }
<a name="55"/>
<a name="56"/>end
</pre></body></html>
