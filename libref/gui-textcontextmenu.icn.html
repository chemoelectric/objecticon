<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>textcontextmenu.icn</title></head><body><pre>
<a name="1"/>package gui
<a name="2"/>
<a name="3"/>import xdg
<a name="4"/>
<a name="5"/>class TextContextMenu(Menu)
<a name="6"/>   private static init()
<a name="7"/>      try_xdg("txt.cut", "edit-cut")
<a name="8"/>      try_xdg("txt.copy", "edit-copy")
<a name="9"/>      try_xdg("txt.paste", "edit-paste")
<a name="10"/>      try_xdg("txt.undo", "edit-undo")
<a name="11"/>      try_xdg("txt.redo", "edit-redo")
<a name="12"/>      try_xdg("txt.select-all", "edit-select-all")
<a name="13"/>   end
<a name="14"/>
<a name="15"/>   private static try_xdg(key, icon)
<a name="16"/>      ImageCache.copy_key(key, IconTheme.find_icon_and_cache(icon, Gui.MENU_ICON_SIZE,, &amp;yes))
<a name="17"/>   end
<a name="18"/>
<a name="19"/>   public override new(parent)
<a name="20"/>      Menu.new()
<a name="21"/>      if parent.has_region() then {
<a name="22"/>         if parent.is_editable() then
<a name="23"/>            add(TextMenuItem().
<a name="24"/>                set_label("Cut").
<a name="25"/>                set_paint_left(ImagePaint().set_cache("txt.cut")).
<a name="26"/>                set_accel("t").
<a name="27"/>                set_label_right("^X").
<a name="28"/>                connect(parent.handle_cut, Event.ACTION))
<a name="29"/>         add(TextMenuItem().
<a name="30"/>             set_label("Copy").
<a name="31"/>             set_paint_left(ImagePaint().set_cache("txt.copy")).
<a name="32"/>             set_label_right("^C").
<a name="33"/>             set_accel("c").
<a name="34"/>             connect(parent.handle_copy, Event.ACTION))
<a name="35"/>      }
<a name="36"/>      if parent.is_editable() then {
<a name="37"/>         add(TextMenuItem().
<a name="38"/>             set_label("Paste").
<a name="39"/>             set_paint_left(ImagePaint().set_cache("txt.paste")).
<a name="40"/>             set_label_right("^V").
<a name="41"/>             set_accel("p").
<a name="42"/>             connect(parent.handle_paste, Event.ACTION))
<a name="43"/>         add(MenuSeparator())
<a name="44"/>         if parent.can_undo() then
<a name="45"/>            add(TextMenuItem().
<a name="46"/>                set_label("Undo").
<a name="47"/>                set_paint_left(ImagePaint().set_cache("txt.undo")).
<a name="48"/>                set_label_right("^Z").
<a name="49"/>                set_accel("u").
<a name="50"/>                connect(parent.handle_undo, Event.ACTION))
<a name="51"/>         if parent.can_redo() then
<a name="52"/>            add(TextMenuItem().
<a name="53"/>                set_label("Redo").
<a name="54"/>                set_paint_left(ImagePaint().set_cache("txt.redo")).
<a name="55"/>                set_label_right("^Y").
<a name="56"/>                set_accel("r").
<a name="57"/>                connect(parent.handle_redo, Event.ACTION))
<a name="58"/>      }
<a name="59"/>      if parent.has_contents() then {
<a name="60"/>         add(MenuSeparator())
<a name="61"/>         add(TextMenuItem().
<a name="62"/>             set_label("Select all").
<a name="63"/>             set_paint_left(ImagePaint().set_cache("txt.select-all")).
<a name="64"/>             set_label_right("^A").
<a name="65"/>             set_accel("a").
<a name="66"/>             connect(parent.handle_select_all, Event.ACTION))
<a name="67"/>      }
<a name="68"/>      tidy()
<a name="69"/>      return
<a name="70"/>   end
<a name="71"/>end
</pre></body></html>
