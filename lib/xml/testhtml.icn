#
# $Id$
#
# This file is in the public domain.
#
# Author: Robert Parlett (parlett@dial.pipex.com)
#

import xml, ipl.options, io, lang

procedure main(a)
   local p, fmt, e, s, d, t
   p := HtmlParser().set_debug_recovery(1)

   t := options(a, "-u!")
   fmt := HtmlFormatter()

   every e := !a do {
      s := Files.file_to_string(e) | stop("couldnt open" || e)
      if \t["u"] then
         s := ucs(s) | stop("Couldn't convert to utf8")
      d := p.parse(s) | stop("couldnt parse " || e)
      fmt.format(d)
      write("--- Document structure")
      to_stdout(d, 3)
      write("------------")
   }
end


