#  Makefile for iyacc, the Icon-enabled version of Berkeley YACC

include ../../Makedefs

DEST	      = .
HDRS	      = defs.h
LDFLAGS	      =
LIBS	      = ws2_32.lib
LINKER	      = $(CC)
MAKEFILE      = Makefile

OBJS	      = closure.obj \
		error.obj \
		lalr.obj \
		lr0.obj \
		main.obj \
		mkpar.obj \
		output.obj \
		reader.obj \
		skeleton.obj \
		symtab.obj \
		verbose.obj \
		warshall.obj

COBJS         =	../../base/common/mlocal.obj ../../base/common/alloc.obj ../../base/common/win32.obj

PRINT	      = pr -f -l88

PROGRAM	      = iyacc

SRCS	      = closure.c \
		error.c \
		lalr.c \
		lr0.c \
		main.c \
		mkpar.c \
		output.c \
		reader.c \
		skeleton.c \
		symtab.c \
		verbose.c \
		warshall.c

all:		$(PROGRAM)

$(PROGRAM):     $(OBJS)
		$(LD) $(LDFLAGS) /SUBSYSTEM:CONSOLE $(OBJS) $(COBJS) $(LIBS) /OUT:iyacc.exe 
		$(INSTALL) iyacc "$(OI_BIN)"

clean:;		@rm -f $(OBJS) $(PROGRAM)

clobber:;	@rm -f $(OBJS) $(PROGRAM)

depend:;	@mkmf -f $(MAKEFILE) PROGRAM=$(PROGRAM) DEST=$(DEST)

index:;		@ctags -wx $(HDRS) $(SRCS)

install:	$(PROGRAM)
		@echo Installing $(PROGRAM) in $(DEST)
		@install -s $(PROGRAM) $(DEST)

listing:;	@$(PRINT) Makefile $(HDRS) $(SRCS) | lpr

lint:;		@lint $(SRCS)

program:        $(PROGRAM)

tags:           $(HDRS) $(SRCS); @ctags $(HDRS) $(SRCS)

test:		$(PROGRAM)
		@cd test; make

###
closure.obj: defs.h
error.obj: defs.h
lalr.obj: defs.h
lr0.obj: defs.h
main.obj: defs.h
mkpar.obj: defs.h
output.obj: defs.h
reader.obj: defs.h
skeleton.obj: defs.h
symtab.obj: defs.h
verbose.obj: defs.h
warshall.obj: defs.h
