<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>constructor.icn</title></head><body><pre>
<a name="1"/>package lang
<a name="2"/>
<a name="3"/>import util(need_string)
<a name="4"/>
<a name="5"/>#
<a name="6"/># This class contains various helpful methods to get information about
<a name="7"/># a record constructor at runtime.
<a name="8"/>#
<a name="9"/>final abstract class Constructor()
<a name="10"/>   # Return the name of the constructor
<a name="11"/>   #
<a name="12"/>   public static native get_name(c)
<a name="13"/>
<a name="14"/>   # Return the constructor of the given record
<a name="15"/>   #
<a name="16"/>   public static native get_constructor(c)
<a name="17"/>
<a name="18"/>   # Return the program this constructor resides in.  The program's &amp;main
<a name="19"/>   # co-expression is returned.
<a name="20"/>   #
<a name="21"/>   public static native get_program(c)
<a name="22"/>
<a name="23"/>   # Return the name of the package in which this constructor resides; fails
<a name="24"/>   # if the constructor is not in a package.
<a name="25"/>   #
<a name="26"/>   public static get_package(c)
<a name="27"/>      return extract_package(get_name(c))
<a name="28"/>   end
<a name="29"/>
<a name="30"/>   # Return the source location of the constructor
<a name="31"/>   # :Returns :
<a name="32"/>   # :  a `Location` instance
<a name="33"/>   #
<a name="34"/>   public static get_location(c)
<a name="35"/>      return Prog.get_global_location(get_name(c), get_program(c))
<a name="36"/>   end
<a name="37"/>
<a name="38"/>   # Generate the field names of the constructor `c`.
<a name="39"/>   #
<a name="40"/>   public static get_field_names(c)
<a name="41"/>      suspend get_field_name(c, 1 to get_n_fields(c))
<a name="42"/>   end
<a name="43"/>
<a name="44"/>   # Return the number of fields in the constructor `c`.
<a name="45"/>   #
<a name="46"/>   public static native get_n_fields(c)
<a name="47"/>
<a name="48"/>   # Return the field index number of the given field in constructor`c`.
<a name="49"/>   # :Parameters :
<a name="50"/>   # :  `c` - the constructor
<a name="51"/>   # :  `field` - either a field name or number
<a name="52"/>   # :Returns :
<a name="53"/>   # :  an integer, being the index
<a name="54"/>   # :Fails :
<a name="55"/>   # :  if the field is unknown
<a name="56"/>   #
<a name="57"/>   public static native get_field_index(c, field)
<a name="58"/>
<a name="59"/>   # Return the field name of the given field in constructor`c`.
<a name="60"/>   # :Parameters :
<a name="61"/>   # :  `c` - the constructor
<a name="62"/>   # :  `field` - either a field name or number
<a name="63"/>   # :Returns :
<a name="64"/>   # :  the field name
<a name="65"/>   # :Fails :
<a name="66"/>   # :  if the field is unknown
<a name="67"/>   #
<a name="68"/>   public static native get_field_name(c, field)
<a name="69"/>
<a name="70"/>   # Return the source location of the given field in constructor`c`.
<a name="71"/>   # :Parameters :
<a name="72"/>   # :  `c` - the constructor
<a name="73"/>   # :  `field` - either a field name or number
<a name="74"/>   # :Returns :
<a name="75"/>   # :  a `Location` instance
<a name="76"/>   # :Fails :
<a name="77"/>   # :  if the field is unknown
<a name="78"/>   #
<a name="79"/>   public static get_field_location(c, field)
<a name="80"/>      return Location!get_field_location_impl(c, field)
<a name="81"/>   end
<a name="82"/>
<a name="83"/>   private static native get_field_location_impl(c, field)
<a name="84"/>
<a name="85"/>   # Lookup a constructor by name
<a name="86"/>   # 
<a name="87"/>   # :Parameters :
<a name="88"/>   # :  `s` - a constructor name
<a name="89"/>   # :  `ce` - a coexpression, representing a loaded program, defaults
<a name="90"/>   #   to the main program
<a name="91"/>   # :Returns :
<a name="92"/>   # :  a constructor
<a name="93"/>   # :Fails :
<a name="94"/>   # :  if the constructor is unknown
<a name="95"/>   #
<a name="96"/>   public static for_name(s, ce)
<a name="97"/>      local t
<a name="98"/>      s := need_string(s)
<a name="99"/>      if not(integer(s)) &amp;
<a name="100"/>         t := Prog.get_named_global(s, ce) &amp;
<a name="101"/>         type(t) == "constructor" then
<a name="102"/>         return t
<a name="103"/>   end
<a name="104"/>end
</pre></body></html>
