<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>WebScraper</title></head><body>
<h1>WebScraper</h1>
<dl>
<dt>Type :</dt><dd>class</dd>
<dt>Package :</dt><dd><a href="ipl.webscraper-package.html" target="listFrame">ipl.webscraper</a></dd>
</dl><p/>
A class to help with web scraping.  In particular, it provides a way
to help lookup particular elements (tags) in a web page, which has a
known element structure.  Having found a desired element, then the
client program can extract the desired data.
<p/>
The class works by taking a sample web page which has the same
structure as the web pages we will subsequently be scraping data
from.  This sample page is called the template, and is like an
ordinary webpage, but contains special directives which mark the
particular points in the document we wish to locate in the pages we
will be scraping data from.
<p/>
There are two types of special directives.  The first is the "scrape
id".  This can either point to a tag, in which case it takes the
form of an attribute :-
<pre>
   &lt;table scrapeid="spellingtable"&gt;
</pre>
or it can be placed at the start of text content :-
<pre>
   &lt;a href="/news/special_reports" class="navigation-wide-list__link"&gt;
       &lt;span&gt;$scrapeid=title$Special Reports&lt;/span&gt;
   &lt;/a&gt;
</pre>
<p/>
The second type of directive is an "anchor".  The idea is that some
unique, non-changing text content is chosen, near to a scrape id
location.  This is then marked as an "anchor", and the scrape id is
made to refer to the anchor.  The scrape id will then be searched
for by first searching for the anchor text, and then by following
the relative path to the scrape location.  This relative path will
hopefully be less prone to change than the path from the scrape to
the root element, which must be used if there is no anchor for the
scrape.
<p/>
An example of an anchor and scrape used together is :-
<pre>
   &lt;table scrapeid="pp:pastparticiple" border="0"&gt;
      &lt;tr&gt;&lt;td align="center"&gt;$anchorid=pp$Past participle&lt;/td&gt;&lt;/tr&gt;
      &lt;tr&gt;&lt;td class="colVerbDef"&gt;gemacht&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
   &lt;/table&gt;
</pre>
<p/>
Here the anchor id is "pp", and the anchor text is "Past
participle".  The scrapeid is "pastparticiple", and the link to the
anchor is indicated by prefixing this with "pp:".  Now, so long as
this relative structure doesn't change, and future documents still
contain the "Past participle" text in the same place, the scrape
will still successfully retrieve the desired element.
<p/>
An anchor can also refer to an element, rather than text :-
<pre>
  &lt;div anchorid="a2" class="definition-block def-text"&gt;
</pre>
Now a reference to this anchor will cause a search for the first
element with the same tag name and attributes in the target
document.
<p/>
A <code>WebScraper</code> instance is created by passing the text data
containing the template document.  This can either be loaded from a
file, or included using a <code>$load</code> directive, if it is not too
unwieldy.
<p/>
Once created, subject web pages can be searched using the <code><a href="ipl.webscraper.WebScraper.html#lookup">lookup</a></code>
method.  This takes a parsed document and a scrape id and returns
the element in the document which corresponds to the scrape id in
the template.
<p/><a href="ipl.webscraper-webscraper.icn.html#19" target="displayFrame">Source - webscraper.icn </a>
<p/>
<table border="1" cellpadding="3" cellspacing="0" width="100%">
<tr bgcolor="#ccccff">
<td colspan=1><font size="+2">
<b>Class summary</b></font></td>
</tr>
</table>
<table border="1" cellpadding="3" cellspacing="0" width="100%">
<tr bgcolor="#eeeeff">
<td><b>Methods defined in this class</b></td></tr>
<tr bgcolor="white"><td>
<a href="#create_anchors">create_anchors()</a>
<a href="#create_path">create_path()</a>
<a href="#do_insert">do_insert()</a>
<a href="#find_anchor_tag">find_anchor_tag()</a>
<a href="#from_file">from_file()</a>
<a href="#from_ucs_file">from_ucs_file()</a>
<a href="#get_ids">get_ids()</a>
<a href="#get_tag_index">get_tag_index()</a>
<a href="#lookup">lookup()</a>
<a href="#new">new()</a>
<a href="#path_to_root">path_to_root()</a>
<a href="#set_debug">set_debug()</a>
</td></tr></table>
<table border="1" cellpadding="3" cellspacing="0" width="100%">
<tr bgcolor="#eeeeff">
<td><b>Variables defined in this class</b></td></tr>
<tr bgcolor="white"><td>
<a href="#debug_flag">debug_flag</a>
<a href="#paths">paths</a>
</td></tr></table>
<p/>
<table border="1" cellpadding="3" cellspacing="0" width="100%">
<tr bgcolor="#ccccff">
<td colspan=1><font size="+2">
<b>Method detail</b></font></td>
</tr>
</table>
<a name="create_anchors"/>
<h3>create_anchors(d, ak, sk)</h3>
private static<p/>
<dl>
<dd>
<p/><a href="ipl.webscraper-webscraper.icn.html#156" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="create_path"/>
<h3>create_path(n, anchor, si)</h3>
private static<p/>
<dl>
<dd>
<p/><a href="ipl.webscraper-webscraper.icn.html#180" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="do_insert"/>
<h3>do_insert(s, n, anchors, si)</h3>
private<p/>
<dl>
<dd>
<p/><a href="ipl.webscraper-webscraper.icn.html#142" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="find_anchor_tag"/>
<h3>find_anchor_tag(d, name, attrs)</h3>
private<p/>
<dl>
<dd>
<p/><a href="ipl.webscraper-webscraper.icn.html#235" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="from_file"/>
<h3>from_file(fn)</h3>
public static<p/>
<dl>
<dd>
Return an instance with template in the given file.
<dl>
<dt>
Parameters :
</dt>
<dd>
<code>fn</code> - the filename.
</dd>
</dl>
<p/><a href="ipl.webscraper-webscraper.icn.html#306" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="from_ucs_file"/>
<h3>from_ucs_file(fn)</h3>
public static<p/>
<dl>
<dd>
Return an instance with template in the given file, which is
first converted to a ucs string.
<dl>
<dt>
Parameters :
</dt>
<dd>
<code>fn</code> - the filename.
</dd>
</dl>
<p/><a href="ipl.webscraper-webscraper.icn.html#315" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="get_ids"/>
<h3>get_ids()</h3>
public<p/>
<dl>
<dd>
Generate the lookup scrape ids this webscraper can search for
<p/><a href="ipl.webscraper-webscraper.icn.html#93" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="get_tag_index"/>
<h3>get_tag_index(n)</h3>
private static<p/>
<dl>
<dd>
<p/><a href="ipl.webscraper-webscraper.icn.html#213" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="lookup"/>
<h3>lookup(d, id)</h3>
public<p/>
<dl>
<dd>
Lookup the given scrape id in the given <code><a href="xml.HtmlDocument.html" target="displayFrame">HtmlDocument</a></code>.  Either
an <code>HTMLElement</code> or text is returned, depending on whether the
scrape directive was a tag attribute, or part of a text content
in the template.
<p/>
<dl>
<dt>
Parameters :
</dt>
<dd>
<code>d</code> - An <code><a href="xml.HtmlDocument.html" target="displayFrame">HtmlDocument</a></code>.
</dd>
<dd>
<code>id</code> - The particular scrape id, corresponding to one of the
ids in the template.
</dd>
</dl>
<p/><a href="ipl.webscraper-webscraper.icn.html#243" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="new"/>
<h3>new(data)</h3>
public<p/>
<dl>
<dd>
Create a new instance using the given template.
<dl>
<dt>
Parameters :
</dt>
<dd>
<code>data</code> - the template, either string or ucs.
</dd>
</dl>
<p/><a href="ipl.webscraper-webscraper.icn.html#108" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="path_to_root"/>
<h3>path_to_root(n)</h3>
private static<p/>
<dl>
<dd>
<p/><a href="ipl.webscraper-webscraper.icn.html#225" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="set_debug"/>
<h3>set_debug(s)</h3>
public<p/>
<dl>
<dd>
Turn on debugging info
<p/><a href="ipl.webscraper-webscraper.icn.html#100" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<table border="1" cellpadding="3" cellspacing="0" width="100%">
<tr bgcolor="#ccccff">
<td colspan=1><font size="+2">
<b>Variable detail</b></font></td>
</tr>
</table>
<a name="debug_flag"/>
<h3>debug_flag</h3>
private<p/>
<dl>
<dd>
<p/><a href="ipl.webscraper-webscraper.icn.html#91" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
<a name="paths"/>
<h3>paths</h3>
private<p/>
<dl>
<dd>
<p/><a href="ipl.webscraper-webscraper.icn.html#90" target="displayFrame">Source - webscraper.icn </a>
</dd>
</dl><hr>
</body></html>
