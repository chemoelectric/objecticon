<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>integral.icn</title></head><body><pre>
<a name="1"/>package ipl.math
<a name="2"/>
<a name="3"/>#-------------------------------------------------------------------------------
<a name="4"/># Name:        integral.icn
<a name="5"/># Purpose:     Numerical integration library
<a name="6"/>#
<a name="7"/># Author:      Oleg Baharew aka ArqricCat (IDP Team)
<a name="8"/>#
<a name="9"/># Created:     01.08.2013
<a name="10"/># Copyright:   (c) IDP Team, 2013
<a name="11"/># Licence:     MIT License
<a name="12"/>
<a name="13"/># Class summary:
<a name="14"/>
<a name="15"/>#  Integral - a class that provides a set of numerical integration methods that are 
<a name="16"/>#  implemented as static methods of this class.
<a name="17"/>
<a name="18"/>#  Methods defined in this class:
<a name="19"/>#     * left_rect(f,a,b,n) - method of left rectangles
<a name="20"/>#     * right_rect(f,a,b,n) - method of right rectangles
<a name="21"/>#     * middle_rect(f,a,b,n) - method of middle rectangles
<a name="22"/>#     * trap_meth(f,a,b,n) - trapezoidal method
<a name="23"/>#     * simpson(f,a,b,n) - simpson method
<a name="24"/>#     * three(f,a,b,n) - Newton-Cotes 3rd method
<a name="25"/>#     * gauss2(f,a,b,n) - Gauss two-point method
<a name="26"/>#     * auto(f,a,b,n) - integration with automatic step selection
<a name="27"/>
<a name="28"/>import 
<a name="29"/>   util(Math)
<a name="30"/>
<a name="31"/>final abstract class Integral()
<a name="32"/>   public static left_rect(f,a,b,n)
<a name="33"/>   local s,h,i,x
<a name="34"/>   s := 0.0
<a name="35"/>   h := (b-a)/n
<a name="36"/>   i := 0
<a name="37"/>   while i &lt;= n do {
<a name="38"/>      x := a + i * h
<a name="39"/>      s +:= f(x)
<a name="40"/>      i +:= 1
<a name="41"/>   }
<a name="42"/>   return s * h
<a name="43"/>   end
<a name="44"/>
<a name="45"/>   public static right_rect(f,a,b,n)
<a name="46"/>   local s,h,i,x
<a name="47"/>   s := 0.0
<a name="48"/>   h := (b-a)/n
<a name="49"/>   i := 1
<a name="50"/>   while i &lt;= n do {
<a name="51"/>      x := a + i * h
<a name="52"/>      s +:= f(x)
<a name="53"/>      i +:= 1
<a name="54"/>   }
<a name="55"/>   return s * h
<a name="56"/>   end
<a name="57"/>
<a name="58"/>   public static middle_rect(f,a,b,n)
<a name="59"/>   local s,h,i,x
<a name="60"/>   s := 0.0
<a name="61"/>   h := (b-a)/n
<a name="62"/>   i := 1
<a name="63"/>   while i &lt;= n do {
<a name="64"/>      x := a + i * h - 0.5 * h
<a name="65"/>      s +:= f(x)
<a name="66"/>      i +:= 1
<a name="67"/>   }
<a name="68"/>   return s * h
<a name="69"/>   end
<a name="70"/>
<a name="71"/>   public static trap_meth(f,a,b,n)
<a name="72"/>   local s,h,i,x
<a name="73"/>   s := (f(a)+f(b))/2.0
<a name="74"/>   h := (b-a)/n
<a name="75"/>   i := 1
<a name="76"/>   while i &lt; n do {
<a name="77"/>      x := a + i * h
<a name="78"/>      s +:= f(x)
<a name="79"/>      i +:= 1
<a name="80"/>   }
<a name="81"/>   return s * h
<a name="82"/>   end
<a name="83"/>
<a name="84"/>   public static simpson(f,a,b,n)
<a name="85"/>   local s,h,i,x
<a name="86"/>   s := 0
<a name="87"/>   n := 2 * n
<a name="88"/>   h := (b-a)/n
<a name="89"/>   i := 0
<a name="90"/>   while i &lt;= n do {
<a name="91"/>      x := a + h * i
<a name="92"/>      if i = 0 | i = n then s +:= f(x) else {
<a name="93"/>         if i%2 = 0 then s +:= 2*f(x) else s +:= 4*f(x)     
<a name="94"/>     }
<a name="95"/>     i +:= 1
<a name="96"/>   }
<a name="97"/>   return s*(h/3.0)
<a name="98"/>   end
<a name="99"/>
<a name="100"/>   public static three(f,a,b,n)
<a name="101"/>   local s,h,i,x
<a name="102"/>   s := 0
<a name="103"/>   h := (b-a)/n
<a name="104"/>   i := 0
<a name="105"/>   while i &lt;= n do {
<a name="106"/>      x := a + h * i
<a name="107"/>      if i = 0 | i = n then s +:= f(x) else {
<a name="108"/>         if i%3 = 0 then s +:= 2*f(x) else s +:= 3*f(x)     
<a name="109"/>     }
<a name="110"/>     i +:= 1
<a name="111"/>   }
<a name="112"/>   return (3.0/8.0) * s * h
<a name="113"/>   end
<a name="114"/>
<a name="115"/>   public static gauss2(f,a,b,n)
<a name="116"/>   local s,h,c,d,x,i
<a name="117"/>   s := 0.0
<a name="118"/>   h := (b - a) / n
<a name="119"/>   c := h / Math.sqrt(3.0)
<a name="120"/>   d := h - c
<a name="121"/>   x := 0.5 * (a + d)
<a name="122"/>   i := 1
<a name="123"/>   while i &lt;= n do {
<a name="124"/>      s +:= f(x)
<a name="125"/>      x +:= c
<a name="126"/>      s +:= f(x)
<a name="127"/>      x +:= d
<a name="128"/>      i +:= 1 
<a name="129"/>   }
<a name="130"/>   return 0.5 * s * h
<a name="131"/>   end
<a name="132"/>
<a name="133"/>   public static auto(f,a,b,eps)
<a name="134"/>   local s1,s2,n
<a name="135"/>   n := 2
<a name="136"/>   s1 := trap_meth(f,a,b,n)
<a name="137"/>   s2 := simpson(f,a,b,n)
<a name="138"/>   while abs(s1-s2) &gt;= eps do {
<a name="139"/>      s1 := trap_meth(f,a,b,n)
<a name="140"/>      s2 := simpson(f,a,b,n)
<a name="141"/>      n *:= 2
<a name="142"/>   }
<a name="143"/>   return (s2 + 2*s1)/ 3.0
<a name="144"/>   end
<a name="145"/>end
</pre></body></html>
