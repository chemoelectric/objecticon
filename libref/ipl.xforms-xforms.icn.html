<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>xforms.icn</title></head><body><pre>
<a name="1"/>############################################################################
<a name="2"/>#
<a name="3"/>#	File:     xforms.icn
<a name="4"/>#
<a name="5"/>#	Subject:  Procedures to do matrix transformations
<a name="6"/>#
<a name="7"/>#	Author:   Stephen W. Wampler and Ralph E. Griswold
<a name="8"/>#
<a name="9"/>#	Date:     May 2, 2001
<a name="10"/>#
<a name="11"/>############################################################################
<a name="12"/>#
<a name="13"/>#   This file is in the public domain.
<a name="14"/>#
<a name="15"/>############################################################################
<a name="16"/>#
<a name="17"/>#  These procedures produce matrices for affine transformation in two
<a name="18"/>#  dimentionsi and transform point lists.
<a name="19"/>#
<a name="20"/>#  A point list is a list of Point() records.  See gobject.icn
<a name="21"/>#
<a name="22"/>############################################################################
<a name="23"/>#
<a name="24"/>#  Links:  matrix
<a name="25"/>#
<a name="26"/>############################################################################
<a name="27"/>
<a name="28"/>package ipl.xforms
<a name="29"/>
<a name="30"/>import
<a name="31"/>   ipl.matrix(identity_matrix, mult_matrix),
<a name="32"/>   util(Math)
<a name="33"/>
<a name="34"/># transform point list by matrix
<a name="35"/>procedure transform(p, M)		
<a name="36"/>   local pl, i
<a name="37"/>
<a name="38"/>   # convert p to a matrix for matrix multiply...
<a name="39"/>
<a name="40"/>   every put((pl := [[]])[1], (!p)|1.0)	# the 1.0 makes it homogeneous
<a name="41"/>
<a name="42"/>   # do the conversion...
<a name="43"/>
<a name="44"/>   pl := mult_matrix(pl, M)
<a name="45"/>
<a name="46"/>   # convert list back to a point list...
<a name="47"/>
<a name="48"/>   p := copy(p)
<a name="49"/>   every i := 1 to *p do
<a name="50"/>      p[i] := pl[1][i]
<a name="51"/>
<a name="52"/>   return p
<a name="53"/>
<a name="54"/>end
<a name="55"/>
<a name="56"/># transform point list
<a name="57"/>procedure transform_points(pl,M)	
<a name="58"/>   local xformed
<a name="59"/>
<a name="60"/>   every put(xformed := [], !transform(!pl,M))
<a name="61"/>
<a name="62"/>   return xformed
<a name="63"/>
<a name="64"/>end
<a name="65"/>   
<a name="66"/># matrix for scaling
<a name="67"/>procedure set_scale(x, y)		
<a name="68"/>   local M
<a name="69"/>
<a name="70"/>   M := identity_matrix(3,3)
<a name="71"/>
<a name="72"/>   M[1][1] := x
<a name="73"/>   M[2][2] := y
<a name="74"/>
<a name="75"/>   return M
<a name="76"/>
<a name="77"/>end
<a name="78"/>
<a name="79"/># matrix for translation
<a name="80"/>procedure set_trans(x, y)		
<a name="81"/>   local M
<a name="82"/>
<a name="83"/>   M := identity_matrix(3,3)
<a name="84"/>
<a name="85"/>   M[*M][1] := x
<a name="86"/>   M[*M][2] := y
<a name="87"/>
<a name="88"/>   return M
<a name="89"/>
<a name="90"/>end
<a name="91"/>
<a name="92"/># matrix for x shear
<a name="93"/>procedure set_xshear(x)			
<a name="94"/>   local M
<a name="95"/>
<a name="96"/>   M :=  identity_matrix(3,3)
<a name="97"/>
<a name="98"/>   M[1][2] := x
<a name="99"/>
<a name="100"/>   return M
<a name="101"/>
<a name="102"/>end
<a name="103"/>
<a name="104"/># matrix for y shear
<a name="105"/>procedure set_yshear(y)			
<a name="106"/>   local M
<a name="107"/>
<a name="108"/>   M := identity_matrix(3,3)
<a name="109"/>
<a name="110"/>   M[2][1] := y
<a name="111"/>
<a name="112"/>   return M
<a name="113"/>
<a name="114"/>end
<a name="115"/>
<a name="116"/># matrix for rotation
<a name="117"/>procedure set_rotate(x)			
<a name="118"/>   local M
<a name="119"/>
<a name="120"/>   M := identity_matrix(3,3)
<a name="121"/>   M[1][1] := Math.cos(x)
<a name="122"/>   M[2][2] := M[1][1]
<a name="123"/>   M[1][2] := Math.sin(x)
<a name="124"/>   M[2][1] := -M[1][2]
<a name="125"/>
<a name="126"/>   return M
<a name="127"/>
<a name="128"/>end
</pre></body></html>
