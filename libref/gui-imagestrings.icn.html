<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>imagestrings.icn</title></head><body><pre>
<a name="1"/>package gui
<a name="2"/>
<a name="3"/>#
<a name="4"/># Various helper procedures for building image strings.
<a name="5"/>#
<a name="6"/>
<a name="7"/>package procedure mk_box_up(d, b)
<a name="8"/>   local s, i
<a name="9"/>   s := ""
<a name="10"/>   s ||:= repl("~", d)
<a name="11"/>   every i := 0 to b-1 do
<a name="12"/>      s ||:= "~" || repl("1", d - 2 - i) || repl("0", i) || "~"
<a name="13"/>   every 1 to d - (2 + 2 * b) do
<a name="14"/>      s ||:= "~" || repl("1", b) || repl("~",d - 2 - 2 * b) || repl("0", b) || "~"
<a name="15"/>   every i := b to 1 by -1 do
<a name="16"/>      s ||:= "~" || repl("1", i) || repl("0", d - 2 - i) || "~"
<a name="17"/>   s ||:= repl("~", d)
<a name="18"/>   return ImageStringInfo.from_parts(d,, "0=shadow;1=hilite;~=transparent", s).to_image_string()
<a name="19"/>end
<a name="20"/>
<a name="21"/>package procedure mk_box_down(d, b)
<a name="22"/>   local s, i
<a name="23"/>   s := ""
<a name="24"/>   s ||:= repl("~", d)
<a name="25"/>   every i := 1 to b do
<a name="26"/>      s ||:= "~" || repl("0", d - 2 - i) || repl("1", i) || "~"
<a name="27"/>   s ||:= "~" || repl("0", b) || repl("~",d - 2 - 2 * b) || repl("1", b) || "~"
<a name="28"/>   every 1 to d - (2 + 2 + 2 * b) do
<a name="29"/>      s ||:= "~" || repl("0", b) || "~" || repl("b",d - 2 - 2 - 2 * b) || "~" || repl("1", b) || "~"
<a name="30"/>   s ||:= "~" || repl("0", b) || repl("~",d - 2 - 2 * b) || repl("1", b) || "~"
<a name="31"/>   every i := b - 1 to 0 by -1 do
<a name="32"/>      s ||:= "~" || repl("0", i) || repl("1", d - 2 - i) || "~"
<a name="33"/>   s ||:= repl("~", d)
<a name="34"/>   return ImageStringInfo.from_parts(d,, "b=black;0=shadow;1=hilite;~=transparent", s).to_image_string()
<a name="35"/>end
<a name="36"/>
<a name="37"/>package procedure mk_diamond_up(d, b)
<a name="38"/>   local s, i, j, m
<a name="39"/>   s := ""
<a name="40"/>   every i := d / 2 to 0 by - 1 do {
<a name="41"/>      j := d - 2 * i
<a name="42"/>      m := if j &gt; 2 * b then
<a name="43"/>         repl("1", b) || repl("~", j - 2 * b) || repl("1", b)
<a name="44"/>      else
<a name="45"/>         repl("1", j)
<a name="46"/>      m[1] := m[-1] := "3"
<a name="47"/>      s ||:= repl("~", i) || m || repl("~", i)
<a name="48"/>   }
<a name="49"/>   every i := 1 to d / 2 do {
<a name="50"/>      j := d - 2 * i
<a name="51"/>      m := if j &gt; 2 * b then
<a name="52"/>         repl("0", b) || repl("~", j - 2 * b) || repl("0", b)
<a name="53"/>      else
<a name="54"/>         repl("0", j)
<a name="55"/>      m[1] := m[-1] := "2"
<a name="56"/>      s ||:= repl("~", i) || m || repl("~", i)
<a name="57"/>   }
<a name="58"/>
<a name="59"/>   return ImageStringInfo.from_parts(d,, "0=shadow;1=hilite;2=shadow,0.5;3=hilite,0.5;~=transparent", s).to_image_string()
<a name="60"/>end
<a name="61"/>
<a name="62"/>package procedure mk_diamond_down(d, b)
<a name="63"/>   local s, i, j, m
<a name="64"/>   s := ""
<a name="65"/>   every i := d / 2 to 0 by - 1 do {
<a name="66"/>      j := d - 2 * i
<a name="67"/>      m := if j = 2 * b + 1 then
<a name="68"/>         repl("0", b) || "~" || repl("0", b)
<a name="69"/>      else if j &gt; 2 * b + 2 then
<a name="70"/>         repl("0", b) || "~" || repl("b", j - 2 * b - 2) || "~" || repl("0", b)
<a name="71"/>      else if j &gt; 2 * b then
<a name="72"/>         repl("0", b) || repl("~", j - 2 * b) || repl("0", b)
<a name="73"/>      else
<a name="74"/>         repl("0", j)
<a name="75"/>      m[1] := m[-1] := "2"
<a name="76"/>      s ||:= repl("~", i) || m || repl("~", i)
<a name="77"/>   }
<a name="78"/>   every i := 1 to d / 2 do {
<a name="79"/>      j := d - 2 * i
<a name="80"/>      m := if j = 2 * b + 1 then
<a name="81"/>         repl("1", b) || "~" || repl("1", b)
<a name="82"/>      else if j &gt; 2 * b + 2 then
<a name="83"/>         repl("1", b) || "~" || repl("b", j - 2 * b - 2) || "~" || repl("1", b)
<a name="84"/>      else if j &gt; 2 * b then
<a name="85"/>         repl("1", b) || repl("~", j - 2 * b) || repl("1", b)
<a name="86"/>      else
<a name="87"/>         repl("1", j)
<a name="88"/>      m[1] := m[-1] := "3"
<a name="89"/>      s ||:= repl("~", i) || m || repl("~", i)
<a name="90"/>   }
<a name="91"/>
<a name="92"/>   return ImageStringInfo.from_parts(d,, "b=black;0=shadow;1=hilite;2=shadow,0.5;3=hilite,0.5;~=transparent", s).to_image_string()
<a name="93"/>end
<a name="94"/>
<a name="95"/>package procedure mk_v_arrow(d)
<a name="96"/>   local s, i, m, j
<a name="97"/>   s := ""
<a name="98"/>   every i := 1 to d by 2 do {
<a name="99"/>      m := repl("b", i)
<a name="100"/>      m[1] := m[-1] := "c"
<a name="101"/>      j := (d - i) / 2
<a name="102"/>      s ||:= repl("~", j) || m || repl("~", d - j - i)
<a name="103"/>   }
<a name="104"/>   return s
<a name="105"/>end
<a name="106"/>
<a name="107"/>package procedure mk_arrow_up(d)
<a name="108"/>   return ImageStringInfo.from_parts(d,, "b=black;c=black 50%;~=transparent", mk_v_arrow(d)).to_image_string()
<a name="109"/>end
<a name="110"/>
<a name="111"/>package procedure mk_arrow_down(d)
<a name="112"/>   return ImageStringInfo.from_parts(d,, "b=black;c=black 50%;~=transparent", reverse(mk_v_arrow(d))).to_image_string()
<a name="113"/>end
<a name="114"/>
<a name="115"/>package procedure mk_h_arrow(d)
<a name="116"/>   local s, i, m
<a name="117"/>   s := ""
<a name="118"/>   every i := (1 to d by 2) | (d - 2 to 1 by -2) do {
<a name="119"/>      m := repl("b", i)
<a name="120"/>      m[1] := "c"
<a name="121"/>      s ||:= repl("~", d - i) || m
<a name="122"/>   }
<a name="123"/>   return s
<a name="124"/>end
<a name="125"/>
<a name="126"/>package procedure mk_arrow_left(d)
<a name="127"/>   return ImageStringInfo.from_parts(d,, "b=black;c=black 50%;~=transparent", mk_h_arrow(d)).to_image_string()
<a name="128"/>end
<a name="129"/>
<a name="130"/>package procedure mk_arrow_right(d)
<a name="131"/>   return ImageStringInfo.from_parts(d,, "b=black;c=black 50%;~=transparent", reverse(mk_h_arrow(d))).to_image_string()
<a name="132"/>end
<a name="133"/>
<a name="134"/>package procedure mk_handle(d, b, fl)
<a name="135"/>   local s, i, j, k, t
<a name="136"/>   s := ""
<a name="137"/>   every 1 to b do
<a name="138"/>      s ||:= repl("b", d)
<a name="139"/>   every 1 to b do
<a name="140"/>      s ||:= repl("b", b) || repl("~", d - 2 * b) || repl("b", b)
<a name="141"/>
<a name="142"/>   j := (d - 3 * b) / 2
<a name="143"/>   t := repl("b", b) || repl("~", j) || repl(if /fl then "b" else "~", b) || repl("~", d - 3 * b - j) || repl("b", b)
<a name="144"/>
<a name="145"/>   k := (d - 5 * b) / 2
<a name="146"/>   every i := 1 to k do
<a name="147"/>      s ||:= t
<a name="148"/>   every 1 to b do
<a name="149"/>      s ||:= repl("b", b) || repl("~", b) || repl("b", d - 4 * b) || repl("~", b) || repl("b", b)
<a name="150"/>   every i := 1 to k do
<a name="151"/>      s ||:= t
<a name="152"/>   every 1 to b do
<a name="153"/>      s ||:= repl("b", b) || repl("~", d - 2 * b) || repl("b", b)
<a name="154"/>   every 1 to b do
<a name="155"/>      s ||:= repl("b", d)
<a name="156"/>   return ImageStringInfo.from_parts(d,, "b=black;~=transparent", s).to_image_string()
<a name="157"/>end
<a name="158"/>
<a name="159"/>package procedure mk_dot(d)
<a name="160"/>   local s, i, j, m
<a name="161"/>   s := ""
<a name="162"/>   every i := (d / 2 to 0 by - 1) | (1 to d / 2) do {
<a name="163"/>      j := d - 2 * i
<a name="164"/>      m := repl("0", j)
<a name="165"/>      m[1] := m[-1] := "2"
<a name="166"/>      s ||:= repl("~", i) || m || repl("~", i)
<a name="167"/>   }
<a name="168"/>   return s
<a name="169"/>end
<a name="170"/>
<a name="171"/>package procedure mk_v_grid(d, i)
<a name="172"/>   local s, t
<a name="173"/>   s := mk_dot(d)
<a name="174"/>   t := repl("~", d * i)
<a name="175"/>   s := s || t || s || t || s
<a name="176"/>   return ImageStringInfo.from_parts(d,, "0=shadow;2=shadow,0.5;~=transparent", s).to_image_string()
<a name="177"/>end
<a name="178"/>
<a name="179"/>package procedure mk_h_grid(d, i)
<a name="180"/>   local r, s, t, u
<a name="181"/>   s := mk_dot(d)
<a name="182"/>   t := repl("~", i)
<a name="183"/>   u := ""
<a name="184"/>   s ? while r := move(d) do
<a name="185"/>      u ||:= r || t || r || t || r 
<a name="186"/>   return ImageStringInfo.from_parts(3 * d + 2 * i,, "0=shadow;2=shadow,0.5;~=transparent", u).to_image_string()
<a name="187"/>end
</pre></body></html>
