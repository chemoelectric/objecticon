<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>indices.icn</title></head><body><pre>
<a name="1"/>############################################################################
<a name="2"/>#
<a name="3"/>#	File:     indices.icn
<a name="4"/>#
<a name="5"/>#	Subject:  Procedure to produce indices
<a name="6"/>#
<a name="7"/>#	Author:   Ralph E. Griswold
<a name="8"/>#
<a name="9"/>#	Date:     June 2, 1998
<a name="10"/>#
<a name="11"/>############################################################################
<a name="12"/>#
<a name="13"/>#   This file is in the public domain.
<a name="14"/>#
<a name="15"/>############################################################################
<a name="16"/>#
<a name="17"/>#	indices(spec, last)
<a name="18"/>#			produces a list of the integers given by the
<a name="19"/>#			specification spec, which is a common separated list
<a name="20"/>#			of either positive integers or integer spans, as in
<a name="21"/>#
<a name="22"/>#				"1,3-10, ..."
<a name="23"/>#
<a name="24"/>#			If last is specified, it it used for a span of
<a name="25"/>#			the form "10-".
<a name="26"/>#
<a name="27"/>#			In an integer span, the low and high values need not
<a name="28"/>#			be in order.  For example, "1-10" and "10-1"
<a name="29"/>#			are equivalent.  Similarly, indices need not be
<a name="30"/>#			in order, as in "3-10, 1, ..."
<a name="31"/>#
<a name="32"/>#			And empty value, as in "10,,12" is ignored.
<a name="33"/>#
<a name="34"/>#			indices() fails if the specification is syntactically
<a name="35"/>#			erroneous or if it contains a value less than 1.
<a name="36"/>#
<a name="37"/>############################################################################
<a name="38"/>
<a name="39"/>package ipl.indices
<a name="40"/>
<a name="41"/># generate indices
<a name="42"/>procedure indices(spec, last)		
<a name="43"/>   local item, hi, lo, result
<a name="44"/>
<a name="45"/>   if \last then last := (0 &lt; integer(last)) | fail
<a name="46"/>
<a name="47"/>   result := set()
<a name="48"/>
<a name="49"/>   spec ? {
<a name="50"/>      while item := tab(upto(',') | 0) do {
<a name="51"/>         if item := integer(item) then
<a name="52"/>            ((insert(result, 0 &lt; item)) | fail)
<a name="53"/>         else if *item = 0 then {
<a name="54"/>             move(1) | break
<a name="55"/>             next
<a name="56"/>             }
<a name="57"/>         else item ? {
<a name="58"/>            (lo := (0 &lt; integer(tab(upto('\-')))) | fail)
<a name="59"/>            move(1)
<a name="60"/>            hi := (if pos(0) then last else
<a name="61"/>               ((0 &lt; integer(tab(0)) | fail)))
<a name="62"/>            /hi := lo
<a name="63"/>            if lo &gt; hi then lo :=: hi
<a name="64"/>            every insert(result, lo to hi)
<a name="65"/>            }
<a name="66"/>         move(1) | break
<a name="67"/>         }
<a name="68"/>      }
<a name="69"/>
<a name="70"/>   return sort(result)
<a name="71"/>
<a name="72"/>end
</pre></body></html>
