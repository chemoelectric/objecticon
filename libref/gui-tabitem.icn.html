<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta charset="UTF-8"><title>tabitem.icn</title></head><body><pre>
<a name="1"/>#
<a name="2"/># $Id: tabitem.icn 8468 2020-09-06 17:24:16Z rparlett $
<a name="3"/>#
<a name="4"/># This file is in the public domain.
<a name="5"/>#
<a name="6"/># Author: Robert Parlett (parlett@dial.pipex.com)
<a name="7"/>#
<a name="8"/>
<a name="9"/>package gui
<a name="10"/>
<a name="11"/>#
<a name="12"/># This class represents a single pane in a `TabSet`.  `Component`s
<a name="13"/># can be added to the `TabItem` using `Component`'s `add` method.
<a name="14"/># They are then displayed and accept input when that TabItem
<a name="15"/># is selected.
<a name="16"/>#
<a name="17"/># Components added to the `TabItem` are positioned relative to
<a name="18"/># the position and size of the parent `TabSet`.  Therefore for
<a name="19"/># example `set_pos("50%", "50%")` refers to the centre of the
<a name="20"/># `TabSet` rather than the centre of the screen.  The components
<a name="21"/># also inherit any window attributes of the `TabSet`, such as
<a name="22"/># font, colour and so on.
<a name="23"/>#
<a name="24"/>class TabItem(Component)
<a name="25"/>   public 
<a name="26"/>      paint,
<a name="27"/>      label_border,
<a name="28"/>      tab_tooltip,
<a name="29"/>      tab_x,
<a name="30"/>      tab_w,
<a name="31"/>      remembered_focus
<a name="32"/>
<a name="33"/>   #
<a name="34"/>   # Set the remembered focus component, which will received the focus
<a name="35"/>   # when the tab is selected (if the parent TabSet is configured with
<a name="36"/>   # set_remember_focus to on).
<a name="37"/>   #
<a name="38"/>   public set_remembered_focus(c)
<a name="39"/>      remembered_focus := c
<a name="40"/>      link
<a name="41"/>   end
<a name="42"/>
<a name="43"/>   #
<a name="44"/>   # Set the `TabItem`'s label.
<a name="45"/>   #
<a name="46"/>   public set_label(x)
<a name="47"/>      set_paint(paint_for_string(x))
<a name="48"/>      link
<a name="49"/>   end
<a name="50"/>
<a name="51"/>   public set_label_border(b)
<a name="52"/>      if is_initialized() then {
<a name="53"/>         (\self.label_border).finally()
<a name="54"/>         self.label_border := b
<a name="55"/>         self.label_border.initially(parent)
<a name="56"/>         self.parent.invalidate_tab_region()
<a name="57"/>      } else
<a name="58"/>         self.label_border := b
<a name="59"/>      link
<a name="60"/>   end
<a name="61"/>
<a name="62"/>   public set_paint(p)
<a name="63"/>      if is_initialized() then {
<a name="64"/>         (\self.paint).finally()
<a name="65"/>         self.paint := p
<a name="66"/>         self.paint.initially(parent, self.accel)
<a name="67"/>         self.parent.invalidate_tab_region()
<a name="68"/>      } else
<a name="69"/>         self.paint := p
<a name="70"/>      link
<a name="71"/>   end
<a name="72"/>
<a name="73"/>   #
<a name="74"/>   # Set the tab tooltip, which is displayed by the TabSet when the
<a name="75"/>   # mouse is over the tab.
<a name="76"/>   #
<a name="77"/>   public set_tab_tooltip(x)
<a name="78"/>      self.tab_tooltip := x
<a name="79"/>      link
<a name="80"/>   end
<a name="81"/>
<a name="82"/>   #
<a name="83"/>   # Return the tab_tooltip, if any.
<a name="84"/>   #
<a name="85"/>   public get_tab_tooltip()
<a name="86"/>      return \self.tab_tooltip
<a name="87"/>   end
<a name="88"/>
<a name="89"/>   public override initially()
<a name="90"/>      \self.paint | runerr("No label specified")
<a name="91"/>      Component.initially()
<a name="92"/>      # We are painted on the TabSet's attributes, so init
<a name="93"/>      # the label border and paint on it too.
<a name="94"/>      self.label_border.initially(parent)
<a name="95"/>      self.paint.initially(parent, self.accel)
<a name="96"/>   end
<a name="97"/>
<a name="98"/>   public override finally()
<a name="99"/>      Component.finally()
<a name="100"/>      paint.finally()
<a name="101"/>      label_border.finally()
<a name="102"/>   end
<a name="103"/>
<a name="104"/>   public get_label_width()
<a name="105"/>      return paint.w + label_border.get_total_width()
<a name="106"/>   end
<a name="107"/>
<a name="108"/>   public get_label_height()
<a name="109"/>      return paint.h + label_border.get_total_height()
<a name="110"/>   end
<a name="111"/>
<a name="112"/>   public draw_label(W, x, y, w, h, focus, highlight)
<a name="113"/>      local r
<a name="114"/>      r := Rect(x, y, w, h)
<a name="115"/>      label_border.draw_rect(W, r)
<a name="116"/>      paint.draw_rect(W, label_border.float(r, paint))
<a name="117"/>      if is_shaded() then
<a name="118"/>         Gui.style.shade_rectangle(W, x, y, w, h)
<a name="119"/>      # The focus and highlight is drawn after shading, since it relates to the parent tabset. 
<a name="120"/>      if \highlight then
<a name="121"/>         label_border.draw_highlight_rect(W, r)
<a name="122"/>      else if \focus then
<a name="123"/>         label_border.draw_focus_rect(W, r)
<a name="124"/>   end
<a name="125"/>
<a name="126"/>   public override new()
<a name="127"/>      Component.new()
<a name="128"/>      self.label_border := EmptyBorder().set_focus_inset(Gui.FINE_WIDTH)
<a name="129"/>      return
<a name="130"/>   end
<a name="131"/>end
</pre></body></html>
